# 开发计划 Phase 1.1.3: 传承与漂移——繁殖、变异与演化

## 1. 目标 (Goals)
本阶段的核心是让世界“动起来”。我们将实现生物的代际传递，通过不断的繁殖与变异，让优势基因在特定环境中沉淀。

- **繁殖机制**: 实现基于能量储备的单性/双性繁殖逻辑。
- **生殖隔离**: 实现基于基因向量距离的“兼容性判定”。
- **基因变异 (Mutation)**: 实现后代基因的漂移逻辑。
- **视觉演化映射**: 基因的变异将直观地反映在个体的混色（Color Tint）上。

## 2. 关键任务 (Key Tasks)

### T1: 繁殖触发逻辑 (Reproduction Trigger)
- [ ] **繁殖状态监测**: 
    - 当 `Energy > MaxEnergy * 0.8` 且年龄达到特定阈值时，进入“求偶/繁殖”状态。
- [ ] **繁殖动作**: 
    - 初期实现简单的“分裂/产卵”模式简化验证；中期引入寻找同类（基因距离相近）的交配逻辑。

### T2: 变异与遗传引擎 (Inheritance & Mutation)
- [ ] **基因传递逻辑**:
    - `ChildGenome = ParentGenome + RandomOffset`。
- [ ] **变异稳定性控制**:
    - 引入 `MutationRate` 变量，确保变异不会导致系统瞬间崩溃（变成混沌），而是温和的漂移。

### T3: 种群判定与生殖隔离 (Speciation)
- [ ] **距离判定算法**:
    - 计算两个个体的基因组向量欧氏距离。
    - 仅当 $D < D_{threshold}$ 时允许交配，否则判定为不同物种。
- [ ] **代际跟踪**: 为单位添加 `Generation` 计数器，记录祖先。

### T4: 演化可视化 (Visualizing Evolution)
- [ ] **颜色映射**:
    - 选取一部分基因位（如 `Aggression` 或 `Metabolism`）映射到实体的 `Sprite.color` (Hue/Saturation)。
    - 玩家可以通过观察颜色块的聚集，直观地在地图上看到“红色种群（好斗者）”或“绿色种群（光合者）”的形成。

## 3. 技术调整
- **新增组件**: `GenerationCount` (u32), `MutationTimer`。
- **系统更新**: `src/simulation/reproduction_system.rs`。

## 4. 预期产物
- 运行游戏一段时间后，你会发现地图上出现了长得不太一样的小人，它们的生命力比第一代更强（或者更弱）。
